apiVersion: argoproj.io/v1alpha1
kind: Application

metadata:
  name: kenobi-{{.Release.Namespace}}-node-red

spec:
  destination:
    namespace: {{.Release.Namespace}}
    name: in-cluster
  project: kenobi
  source:
    chart: node-red
    repoURL: https://k8s-at-home.com/charts/
    targetRevision: 10.0.0
    helm:
      releaseName: node-red
      values: |-
        image:
          tag: 2.2.2-16
        env:
          TZ: America/New_York
        persistence:
          data:
            enabled: true
            accessMode: ReadWriteOnce
            size: 1Gi
        securityContext:
          runAsUser: 1000
          runAsGroup: 1000
        podSecurityContext:
          runAsUser: 1000
          runAsGroup: 1000
          fsGroup: 1000
  syncPolicy:
    automated:
      prune: true
