apiVersion: argoproj.io/v1alpha1
kind: Application

metadata:
  name: kenobi-monitoring-grafana
  namespace: argocd

spec:
  destination:
    namespace: monitoring
    name: in-cluster
  project: kenobi
  source:
    chart: grafana
    repoURL: https://charts.bitnami.com/bitnami
    targetRevision: 7.9.8
    helm:
      releaseName: grafana
      values: |-
        admin:
          user: admin
          password: changeme
        config:
          useGrafanaIniFile: true
          grafanaIniSecret: grafana-ini
        grafana:
          podAnnotations:
            telegraf.influxdata.com/class: infra
            telegraf.influxdata.com/interval: 30s
            telegraf.influxdata.com/path: /metrics
            telegraf.influxdata.com/port: "3000"
            telegraf.influxdata.com/scheme: http
        persistence:
          enabled: false
