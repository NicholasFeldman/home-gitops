apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet

metadata:
  name: skywalker
  namespace: argocd

spec:
  generators:
    - list:
        elements:
          - name: argocd
          - name: auth
          - name: cert-manager
          - name: database
          - name: home
          - name: istio-system
          - name: kube-system
          - name: longhorn-system
          - name: media
          - name: metallb-system
          - name: monitoring
          - name: operators
  template:
    metadata:
      name: 'skywalker-{{name}}'
    spec:
      project: skywalker
      source:
        repoURL: git@github.com:NicholasFeldman/home-gitops.git
        targetRevision: HEAD
        path: 'kubernetes/skywalker/{{name}}'
      destination:
        server: https://kubernetes.default.svc
        namespace: '{{name}}'
